FROM node:5
MAINTAINER Octoblu, Inc. <docker@octoblu.com>

ENV NODE_TLS_REJECT_UNAUTHORIZED 0
ADD npmrc-dev /root/.npmrc

ADD .npmrc /root/.npmrc-auth
RUN cat /root/.npmrc-auth >>/root/.npmrc

WORKDIR /usr/src/app

ADD package.json /usr/src/app/
RUN ["npm", "install", "--production", "--silent"]

ADD . /usr/src/app

CMD ["node", "--max-old-space-size=150", "command.js"]
