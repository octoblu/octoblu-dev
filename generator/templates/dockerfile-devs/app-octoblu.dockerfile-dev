FROM node:5
MAINTAINER Octoblu, Inc. <docker@octoblu.com>

EXPOSE 80
ENV NODE_TLS_REJECT_UNAUTHORIZED 0
ADD npmrc-dev /root/.npmrc

ENV PATH $PATH:/usr/local/bin

WORKDIR /usr/src/app/bower/lib
WORKDIR /usr/src/app/bower_components
WORKDIR /usr/src/app

ADD package.json /usr/src/app/
RUN npm install --production --silent

ADD gulpfile.js /usr/src/app
ADD bower.json /usr/src/app
RUN node_modules/gulp/bin/gulp.js bower:concat

ADD . /usr/src/app
CMD node_modules/gulp/bin/gulp.js watch
